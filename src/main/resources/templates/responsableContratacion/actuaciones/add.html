<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Añadir Contrato - [[${session.userName}]]</title>
  <link rel="stylesheet" type="text/css" th:href="@{/styles/menu_lateral.css}"/>
  <link rel="stylesheet" type="text/css" th:href="@{/styles/add_festival.css}"/>

</head>
<body>
<div class="topbar">
  <p>Usuario: <span th:text="${session.userName}">Nombre Usuario</span></p>
</div>
<div class="rightbar"></div>
<nav class="sidebar">
  <a href="#" class="titulo">Explorar</a>
  <div class="menu-content">
    <ul class="menu-items">
      <li class="item">
        <a href="/responsableContratacion/indexRC" class="submenu-item">
          <span>Inicio</span>
          <i class="fa-solid fa-chevron-right"></i>
        </a>
      </li>


      <li class="item">
        <a href="responsablecontratacion/contracteartista/list" class="submenu-item">
          <span>Gestionar Contratos</span>
          <i class="fa-solid fa-chevron-right"></i>
        </a>
      </li>

      <li class="item">
        <a href="responsablecontratacion/artista/list" class="submenu-item">
          <span>Gestionar Artistas</span>
          <i class="fa-solid fa-chevron-right"></i>
        </a>
      </li>

      <li class="item">
        <a href="festival/list" class="submenu-item">
          <span>Festivales</span>
          <i class="fa-solid fa-chevron-right"></i>
        </a>
      </li>

      <li class="item">
        <a href="/logout" class="submenu-item">
          <span>Cerrar Sesión</span>
          <i class="fa-solid fa-chevron-right"></i>
        </a>
      </li>
    </ul>
  </div>
</nav>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        // Inicializar con una actuación base
        let actuacionIndex = 0;

        $('#addActuacionBtn').click(function() {
            actuacionIndex++;
            $('.actuaciones-section').append(`
                <div class="actuacion" id="actuacion-${actuacionIndex}">
                    <h3>Actuación ${actuacionIndex + 1}</h3>
                    <input type="hidden" name="actuaciones[${actuacionIndex}].index" value="${actuacionIndex}"/>

                    <div class="form-group">
                        <label for="idFestival">Seleccionar Festival</label>
                        <select class="form-control" id="idFestival" th:field="*{actuaciones[${actuacionIndex}].idFestival}" required>
                            <option th:each="festival : ${festivales}" th:value="${festival.idFestival}" th:text="${festival.nom}"></option>
                        </select>
                        <div th:if="${#fields.hasErrors('contrato.idArtista')}" th:errors="*{contrato.idArtista}" class="error-message"></div>
                        </div>
                    <div class="form-group">
                        <label for="actuaciones[${actuacionIndex}].data">Fecha de la Actuación</label>
                        <input type="date" class="form-control" id="actuaciones${actuacionIndex}.data" name="actuaciones[${actuacionIndex}].data" required/>
                    </div>

                    <div class="form-group">
                        <label for="actuaciones[${actuacionIndex}].horaInici">Hora de Inicio</label>
                        <input type="time" class="form-control" id="actuaciones${actuacionIndex}.horaInici" name="actuaciones[${actuacionIndex}].horaInici" required/>
                    </div>

                    <div class="form-group">
                        <label for="actuaciones[${actuacionIndex}].horaFiPrevista">Hora de Fin Prevista</label>
                        <input type="time" class="form-control" id="actuaciones${actuacionIndex}.horaFiPrevista" name="actuaciones[${actuacionIndex}].horaFiPrevista" required/>
                    </div>

                    <div class="form-group">
                        <label for="actuaciones[${actuacionIndex}].preuContracteActuacio">Precio del Contrato de la Actuación</label>
                        <input type="number" class="form-control" id="actuaciones${actuacionIndex}.preuContracteActuacio" name="actuaciones[${actuacionIndex}].preuContracteActuacio" required/>
                    </div>

                    <div class="form-group">
                        <label for="actuaciones[${actuacionIndex}].comentaris">Comentarios</label>
                        <textarea class="form-control" id="actuaciones${actuacionIndex}.comentaris" name="actuaciones[${actuacionIndex}].comentaris" maxlength="500"></textarea>
                    </div>
                </div>
            `);
        });

        $('#removeActuacionBtn').click(function() {
            if (actuacionIndex >= 0) {
                $(`#actuacion-${actuacionIndex}`).remove();
                actuacionIndex--;
            }
        });
    });
    </script>

<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<!-- Sección para añadir actuaciones -->
<div class="actuaciones-section">
  <h2>Añadir Actuaciones</h2>

  <div class="actuacion" id="actuacion-0">
    <form class="form" th:action="@{/responsablecontratacion/contracteartista/add}" th:object="${contratoActuaciones}" method="POST" novalidate>
      <h1><strong>Contrato con <span th:text="${contrato.idArtista}"></span></strong></h1>


      <div class="form-group">
        <label>Fecha de Inicio:</label>
        <span th:text="${contrato.dataInici}"></span>
      </div>

      <div class="form-group">
        <label>Fecha de Fin:</label>
        <span th:text="${contrato.dataFi}"></span>
      </div>

      <div class="form-group">
        <label>Importe:</label>
        <span th:text="${contrato.importContracte}"></span>
      </div>

      <div class="form-group">
        <label>Número de actuaciones:</label>
        <span th:text="${contrato.numActuacionsAny}"></span>
      </div>

    <h3>Actuación 1</h3>
    <input type="hidden" name="actuaciones[0].index" value="0"/>

    <div class="form-group">
      <label for="idFestival">Seleccionar Festival</label>
      <select class="form-control" id="idFestival" th:field="*{actuaciones[0].idFestival}" required>
        <option th:each="festival : ${festivales}" th:value="${festival.idFestival}" th:text="${festival.nom}"></option>
      </select>
      <div th:if="${#fields.hasErrors('contrato.idArtista')}" th:errors="*{contrato.idArtista}" class="error-message"></div>
    </div>

    <div class="form-group">
      <label for="actuaciones[0].data">Fecha de la Actuación</label>
      <input type="date" class="form-control" id="actuaciones0.data" name="actuaciones[0].data" required/>
    </div>

    <div class="form-group">
      <label for="actuaciones[0].horaInici">Hora de Inicio</label>
      <input type="time" class="form-control" id="actuaciones0.horaInici" name="actuaciones[0].horaInici" required/>
    </div>

    <div class="form-group">
      <label for="actuaciones[0].horaFiPrevista">Hora de Fin Prevista</label>
      <input type="time" class="form-control" id="actuaciones0.horaFiPrevista" name="actuaciones[0].horaFiPrevista" required/>
    </div>

    <div class="form-group">
      <label for="actuaciones[0].preuContracteActuacio">Precio del Contrato de la Actuación</label>
      <input type="number" class="form-control" id="actuaciones0.preuContracteActuacio" name="actuaciones[0].preuContracteActuacio" required/>
    </div>

    <div class="form-group">
      <label for="actuaciones[0].comentaris">Comentarios</label>
      <textarea class="form-control" id="actuaciones0.comentaris" name="actuaciones[0].comentaris" maxlength="500"></textarea>
    </div>
  </div>
</div>

<button type="button" class="button" id="addActuacionBtn">Agregar Otra Actuación</button>
<button type="button" class="button" id="removeActuacionBtn">Eliminar Actuación</button>

</body>
</html>